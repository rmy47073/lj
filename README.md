# YOLOv10 实时物体检测系统 - 使用说明

## 项目结构
```
lj/
├── app/                    # 主应用模块
│   ├── config/            # 配置文件
│   ├── model/             # YOLO模型相关
│   ├── service/           # 业务逻辑服务
│   ├── util/              # 工具类（摄像头处理）
│   └── routes.py          # API路由
├── static/                # 静态资源
├── templates/            # HTML模板
├── videos/               # 视频文件目录（已创建）
├── app.py               # 应用入口
├── yolov10n.pt         # YOLO模型文件
└── test_camera.py       # 摄像头测试工具
```

## 摄像头连接问题解决方案

### 1. 已修复的问题
- 修复了模型文件路径错误（从 `models/yolo11n.pt` 改为 `yolov10n.pt`）
- 创建了缺失的 `videos` 文件夹
-  改进了摄像头错误处理和调试信息
- 添加了摄像头参数设置以提高兼容性

### 2. 摄像头测试
运行以下命令测试摄像头：
```bash
# 测试所有可用摄像头
python test_camera.py

# 测试指定摄像头ID
python test_camera.py 0
```

### 3. 启动应用
```bash
python app.py
```

### 4. 访问应用
打开浏览器访问：http://localhost:5000

### 5. 使用步骤
1. 选择源类型：电脑摄像头
2. 设置摄像头ID（通常为0）
3. 点击"开始检测"
4. 如果摄像头无法连接，请检查：
   - 摄像头是否被其他程序占用
   - 浏览器是否允许摄像头权限
   - 摄像头驱动是否正常

### 6. 常见问题解决

#### 摄像头无法连接
1. **检查摄像头权限**：确保浏览器允许访问摄像头
2. **检查摄像头占用**：关闭其他使用摄像头的程序
3. **尝试不同摄像头ID**：使用测试工具找到正确的摄像头ID
4. **检查驱动**：确保摄像头驱动正常安装

#### 模型文件问题
- 确保 `yolov10n.pt` 文件在项目根目录
- 文件大小应该约为几MB

#### 视频文件功能
- 将视频文件放入 `videos` 文件夹
- 支持常见视频格式（mp4, avi, mov等）

### 7. 系统功能与特性

#### 核心功能
1. **多源视频输入**
   - 支持IP摄像头
   - 支持本地USB摄像头
   - 支持本地视频文件

2. **实时检测与跟踪**
   - 基于YOLOv10的目标检测
   - 多目标跟踪
   - 实时轨迹显示

3. **数据分析功能**
   - 车辆计数统计
   - 车辆分类统计
   - 交通流量监控
   - 停留时间分析
   - 热区监控（如禁停区域）

4. **可视化功能**
   - 实时视频流显示
   - 鸟瞰视图转换
   - 车道线绘制
   - 轨迹可视化
   - 统计数据展示

#### 技术架构
- 后端：Flask + OpenCV + YOLOv10
- 前端：HTML5 + jQuery + AJAX
- 视频处理：OpenCV
- 深度学习：YOLOv10 + Ultralytics
- 多线程处理确保界面响应
- RESTful API设计

### 8. API接口说明

#### 基础接口
- `/`: 主页面
- `/fileList`: 获取可用视频文件列表
- `/getOneFrame`: 获取单帧图像

#### 服务控制接口
- `/start`: 启动检测服务
- `/release/<service_id>`: 释放服务资源

#### 数据获取接口
- `/getRowFrame/<service_id>`: 获取原始视频帧
- `/getProcessedFrame/<service_id>`: 获取处理后的帧
- `/getBirdViewFrame/<service_id>`: 获取鸟瞰视图
- `/getStatistics/<service_id>`: 获取统计数据

### 9. 后续优化方向
1. 添加更多检测模型支持
2. 优化检测性能
3. 增强数据分析功能
4. 改进用户界面交互
5. 添加数据持久化功能
